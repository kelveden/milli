/*! milli 2013-11-22 */
(function(t){function e(t,e){function n(t){o.respondWith.status=t,this.body=function(t,e){return o.respondWith.body=t,o.respondWith.contentType=e,this},this._addStubRequestBody=o}var o={criteria:{url:e,method:t},respondWith:{}};this.body=function(t,e){return o.criteria.body=t,o.criteria.contentType=e,this},this.respondWith=function(t){return new n(t)}}function n(t,e){i.open("POST","http://localhost:"+r+"/_vanilli/expect",!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?e():400===i.status?e(Error("Stub was invalid. "+i.responseText)):e(Error("Could not add stub. "+i.responseText)))},i.setRequestHeader("Content-Type","application/json"),i.send(t)}function o(t){i.open("DELETE","http://localhost:"+r+"/_vanilli/expect",!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t():t(Error("Could not clear stubs. "+i.responseText)))},i.send()}var r,i;t.milli={configure:function(t){if(!t)throw Error("Config must be specified.");if(!t.port)throw Error("config.port must be specified.");r=t.port,i=new XMLHttpRequest},stub:function(t,e){if(!t)throw Error("Stub content must be specified.");if(!e)throw Error("Done callback must be specified.");n(JSON.stringify(t._addStubRequestBody),e)},clearStubs:function(t){o(t)}},t.onRequestTo=function(t,n){return new e(t,n)},t.onGetTo=function(e){return t.onRequestTo("GET",e)},t.onDeleteTo=function(e){return t.onRequestTo("DELETE",e)},t.onPutTo=function(e){return t.onRequestTo("PUT",e)},t.onPostTo=function(e){return t.onRequestTo("POST",e)}})(window.exports?window.exports:window);